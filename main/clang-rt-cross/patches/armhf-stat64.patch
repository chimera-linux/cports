--- a/compiler-rt/lib/sanitizer_common/sanitizer_linux.cpp	2024-03-29 14:26:31.179049747 +0100
+++ b/compiler-rt/lib/sanitizer_common/sanitizer_linux.cpp	2024-03-29 14:40:55.655187784 +0100
@@ -285,25 +285,6 @@
   return res;
 }
 
-#if (!SANITIZER_LINUX_USES_64BIT_SYSCALLS || SANITIZER_SPARC) && SANITIZER_LINUX
-static void stat64_to_stat(struct stat64 *in, struct stat *out) {
-  internal_memset(out, 0, sizeof(*out));
-  out->st_dev = in->st_dev;
-  out->st_ino = in->st_ino;
-  out->st_mode = in->st_mode;
-  out->st_nlink = in->st_nlink;
-  out->st_uid = in->st_uid;
-  out->st_gid = in->st_gid;
-  out->st_rdev = in->st_rdev;
-  out->st_size = in->st_size;
-  out->st_blksize = in->st_blksize;
-  out->st_blocks = in->st_blocks;
-  out->st_atime = in->st_atime;
-  out->st_mtime = in->st_mtime;
-  out->st_ctime = in->st_ctime;
-}
-#endif
-
 #if SANITIZER_LINUX && defined(__loongarch__)
 static void statx_to_stat(struct statx *in, struct stat *out) {
   internal_memset(out, 0, sizeof(*out));
@@ -392,16 +373,12 @@
   return internal_syscall(SYSCALL(newfstatat), AT_FDCWD, (uptr)path, (uptr)buf,
                           0);
 #    else
-  struct stat64 buf64;
   int res = internal_syscall(SYSCALL(fstatat64), AT_FDCWD, (uptr)path,
-                             (uptr)&buf64, 0);
-  stat64_to_stat(&buf64, (struct stat *)buf);
+                             buf, 0);
   return res;
 #    endif
 #  else
-  struct stat64 buf64;
-  int res = internal_syscall(SYSCALL(stat64), path, &buf64);
-  stat64_to_stat(&buf64, (struct stat *)buf);
+  int res = internal_syscall(SYSCALL(stat64), path, buf);
   return res;
 #  endif
 }
@@ -424,16 +401,12 @@
   return internal_syscall(SYSCALL(newfstatat), AT_FDCWD, (uptr)path, (uptr)buf,
                           AT_SYMLINK_NOFOLLOW);
 #    else
-  struct stat64 buf64;
   int res = internal_syscall(SYSCALL(fstatat64), AT_FDCWD, (uptr)path,
-                             (uptr)&buf64, AT_SYMLINK_NOFOLLOW);
-  stat64_to_stat(&buf64, (struct stat *)buf);
+                             buf, AT_SYMLINK_NOFOLLOW);
   return res;
 #    endif
 #  else
-  struct stat64 buf64;
-  int res = internal_syscall(SYSCALL(lstat64), path, &buf64);
-  stat64_to_stat(&buf64, (struct stat *)buf);
+  int res = internal_syscall(SYSCALL(lstat64), path, buf);
   return res;
 #  endif
 }
@@ -456,9 +429,7 @@
   return internal_syscall(SYSCALL(fstat), fd, (uptr)buf);
 #      endif
 #else
-  struct stat64 buf64;
-  int res = internal_syscall(SYSCALL(fstat64), fd, &buf64);
-  stat64_to_stat(&buf64, (struct stat *)buf);
+  int res = internal_syscall(SYSCALL(fstat64), fd, buf);
   return res;
 #endif
 }
