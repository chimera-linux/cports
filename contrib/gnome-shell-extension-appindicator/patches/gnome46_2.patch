From 583e47d46d1489d4515cf84333779692699a663c Mon Sep 17 00:00:00 2001
From: Sergio Costas Rodriguez <sergio.costas@canonical.com>
Date: Mon, 19 Feb 2024 17:18:36 +0100
Subject: [PATCH 1/2] Replace add_actor and remove_actor

Both methods must be replaced in Gnome 46.
---
 indicatorStatusIcon.js |  8 ++++----
 util.js                | 14 ++++++++++++++
 2 files changed, 18 insertions(+), 4 deletions(-)

diff --git a/indicatorStatusIcon.js b/indicatorStatusIcon.js
index 5ef516c..a9e2ac7 100644
--- a/indicatorStatusIcon.js
+++ b/indicatorStatusIcon.js
@@ -276,15 +276,15 @@ class IndicatorStatusIcon extends BaseStatusIcon {
                     yAlign: Clutter.ActorAlign.CENTER,
                 });
                 this._label = new St.Label();
-                this._labelBin.add_actor(this._label);
-                this._box.add_actor(this._labelBin);
+                Util.addActor(this._labelBin, this._label);
+                Util.addActor(this._box, this._labelBin);
             }
             this._label.set_text(label);
             if (!this._box.contains(this._labelBin))
-                this._box.add_actor(this._labelBin); // FIXME: why is it suddenly necessary?
+                Util.addActor(this._box, this._labelBin); // FIXME: why is it suddenly necessary?
         } else if (this._label) {
             this._labelBin.destroy_all_children();
-            this._box.remove_actor(this._labelBin);
+            Util.removeActor(this._box, this._labelBin);
             this._labelBin.destroy();
             delete this._labelBin;
             delete this._label;
diff --git a/util.js b/util.js
index a793404..89133f0 100644
--- a/util.js
+++ b/util.js
@@ -375,6 +375,20 @@ export function tryCleanupOldIndicators() {
     new Set(indicators).forEach(i => i.destroy());
 }
 
+export function addActor(obj, actor) {
+    if (obj.add_actor)
+        obj.add_actor(actor)
+    else
+        obj.add_child(actor)
+}
+
+export function removeActor(obj, actor) {
+    if (obj.remove_actor)
+        obj.remove_actor(actor)
+    else
+        obj.remove_child(actor)
+}
+
 export const CancellableChild = GObject.registerClass({
     Properties: {
         'parent': GObject.ParamSpec.object(

From 3d55c71cb98ff8a97d1658dbf72ceb7b8981c8b9 Mon Sep 17 00:00:00 2001
From: Sergio Costas Rodriguez <sergio.costas@canonical.com>
Date: Mon, 19 Feb 2024 17:21:41 +0100
Subject: [PATCH 2/2] Fix eslint

---
 util.js | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/util.js b/util.js
index 89133f0..0aba244 100644
--- a/util.js
+++ b/util.js
@@ -377,16 +377,16 @@ export function tryCleanupOldIndicators() {
 
 export function addActor(obj, actor) {
     if (obj.add_actor)
-        obj.add_actor(actor)
+        obj.add_actor(actor);
     else
-        obj.add_child(actor)
+        obj.add_child(actor);
 }
 
 export function removeActor(obj, actor) {
     if (obj.remove_actor)
-        obj.remove_actor(actor)
+        obj.remove_actor(actor);
     else
-        obj.remove_child(actor)
+        obj.remove_child(actor);
 }
 
 export const CancellableChild = GObject.registerClass({
